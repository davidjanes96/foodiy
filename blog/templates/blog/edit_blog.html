{% extends 'index.html' %}


{% block content %}
<style type="text/css">
   .create-form {
	    width: 100%;
	    max-width: 100%;
	    padding: 15px;
	    margin: auto;
  	}

  	.submit-button{
  		max-width: 200px;
  	}

	.image {
	  opacity: 1;
	  transition: .5s ease;
	  backface-visibility: hidden;
	}

	.middle {
	  transition: .5s ease;
	  opacity: 0;
	  position: absolute;
	  text-align: center;
	  top: 50%;
	  left: 50%;
	  transform: translate(-50%, -50%);
	
	}
	.image-group{
		position: relative;
  		text-align: center;
  		cursor:pointer;
	}

	.image-group:hover .image {
	  opacity: 0.3;
	}

	.image-group:hover .middle {
	  opacity: 1;
	}

	.text {
	  margin: auto;
	  background-color: #0066ff;
	  color: white;
	  font-size: 15px;
	  padding: 15px;
	}
	.add-button{
        max-width: 100px;
    }
	.sirina {
        max-width: 150px;
    }
</style>

<div class="container">
	<div class="row">
		<div class="col-lg-8 offset-lg-2 card shadow mb-3">
			<h1 class="h3 mb-3 font-weight-normal text-center mt-4">Uređivanje</h1>
			{% if success_message %}
				<i class="fa fa-check fa-3x" style="color:green; text-align: center;"></i>
				<h4 class="pb-3" style="color:green; text-align: center;" >{{success_message}}</h4>
				<p class="m-auto"><a href="{% url 'home' %}">Povratak na naslovnicu.</a></p>
			{% endif %}	

			<form class="create-form" method="post" enctype="multipart/form-data">{% csrf_token %}

				<!-- title -->
				<div class="form-group">
					<label for="id_title">Naziv:</label>
					<input class="form-control" type="text" name="title" id="id_title" maxlength="49" placeholder="Unesi naziv" value="{{form.initial.title}}" required autofocus>
				</div>

				<!-- Body -->
				<div class="form-group">
					<label for="id_body">Opis:</label>
					<textarea class="form-control" rows="4" type="text" name="body" id="id_body" maxlength="499" placeholder="Ovdje unesi opis recepta..." 
					required>{{form.initial.body}}</textarea>
                </div>

				<!-- Sastojci -->
				<div class="form-group">
                    <label for="id_ingredient">Sastojci:</label>	
                    <div class="input_fields_wrap">
                        <div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_0" value="{{form.initial.ingredient_0}}">
                        </div>
						{% if form.initial.ingredient_1 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_1" value="{{form.initial.ingredient_1}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_2 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_2" value="{{form.initial.ingredient_2}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_3 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_3" value="{{form.initial.ingredient_3}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_4 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_4" value="{{form.initial.ingredient_4}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_5 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_5" value="{{form.initial.ingredient_5}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_6 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_6" value="{{form.initial.ingredient_6}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_7 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_7" value="{{form.initial.ingredient_7}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_8 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_8" value="{{form.initial.ingredient_8}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_9 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_9" value="{{form.initial.ingredient_9}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_10 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_10" value="{{form.initial.ingredient_10}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_11 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_11" value="{{form.initial.ingredient_11}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_12 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_12" value="{{form.initial.ingredient_12}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_13 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_13" value="{{form.initial.ingredient_13}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_14 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_14" value="{{form.initial.ingredient_14}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_15 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_15" value="{{form.initial.ingredient_15}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_16 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_16" value="{{form.initial.ingredient_16}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_17 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_17" value="{{form.initial.ingredient_17}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_18 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_18" value="{{form.initial.ingredient_18}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.ingredient_19 %}
						<div>
                            <input type="text" class="form-control broj" maxlength="90" name="ingredient_19" value="{{form.initial.ingredient_19}}">
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}

                    </div>
                    <div class="mt-2">
                        <button class="m-auto btn btn-outline-primary btn-block add-button add_field_button">Dodaj</button>
                    </div>
                </div>

				<!-- Koraci -->
				<div class="form-group">
                    <label for="id_step">Koraci:</label>	
                    <div class="input_fields_wrap_step">
                        <div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_0">{{form.initial.step_0}}</textarea>
                        </div>
						{% if form.initial.step_1 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_1">{{form.initial.step_1}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_2 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_2">{{form.initial.step_2}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_3 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_3">{{form.initial.step_3}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_4 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_4">{{form.initial.step_4}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_5 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_5">{{form.initial.step_5}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_6 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_6">{{form.initial.step_6}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_7 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_7">{{form.initial.step_7}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_8 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_8">{{form.initial.step_8}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_9 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_9">{{form.initial.step_9}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_10 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_10">{{form.initial.step_10}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_11 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_11">{{form.initial.step_11}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_12 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_12">{{form.initial.step_12}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_13 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_13">{{form.initial.step_13}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_14 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_14">{{form.initial.step_14}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_15 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_15">{{form.initial.step_15}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_16 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_16">{{form.initial.step_16}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_17 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_17">{{form.initial.step_17}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_18 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_18">{{form.initial.step_18}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}
						{% if form.initial.step_19 %}
						<div>
                            <textarea type="text" rows="3" class="form-control broj-step" maxlength="499" name="step_19">{{form.initial.step_19}}</textarea>
							<a href="#" class="remove_field">Izbriši</a>
                        </div>
						{% endif %}

                    </div>
                    <div class="mt-2">
                        <button class="m-auto btn btn-outline-primary btn-block add-button add_field_button_step">Dodaj</button>
                    </div>
                </div>

				<!-- Vrijeme i kalorije -->
                <div class="row m-auto pb-3">
                    <div class="form-group m-auto">
                        <label for="id_time">Vrijeme pripreme:</label>
                        <div class="row m-auto">
                            <input class="form-control sirina" type="number" min="0" name="time" id="id_time" placeholder="Vrijeme" value="{{form.initial.time}}" required>
                            <p class="mt-1 ml-1">min</p>
                        </div>
                    </div>
                    <div class="form-group m-auto">
                        <label for="id_calories">Količina kalorija:</label>
                        <div class="row m-auto">
                            <input class="form-control sirina" type="number" min="0" name="calories" id="id_calories" placeholder="Kalorije" value="{{form.initial.calories}}" required>
                            <p class="mt-1 ml-1">kcal</p>
                        </div>
                    </div>

                </div>
                
                <!-- Category -->
                <div class="form-group">
					<h6 class="card-title">Kategorija:</h3>
                    <select class="form-select form-select-lg form-control" id="inputCategory" name="category" required>
                        <option value="{{form.initial.category}}"selected>{{form.initial.get_category_display}}</option>
                        <option value="1">Doručak</option>
                        <option value="2">Hladno predjelo</option>
                        <option value="3">Toplo predjelo</option>
                        <option value="4">Glavno jelo</option>
                        <option value="5">Desert</option>
                        <option value="6">Salate</option>
                        <option value="7">Prilozi</option>
                        <option value="8">Ostalo</option>
                    </select>
                </div>

				<!-- Image -->
				<div class="form-group image-group" id="id_image_group">
					<img class="img-fluid image" src="{{form.initial.image.url}}" id="id_image_display">
					  <div class="middle">
					    <div class="text">Promijeni sliku</div>
					  </div>
				</div>
				<input type="file" name="image" id="id_image_file" accept="image/*" onchange="readURL(this)">
				

				{% for field in form %}
					<p>
						{% for error in field.errors %}
							<p style="color: red">{{ error }}</p>
						{% endfor %}
					</p>
				{% endfor %}
				{% if form.non_field_errors %}
					<div style="color: red">
						<p>{{form.non_field_errors}}</p>
					</div>
				{% endif %}

				<!-- Submit btn -->
				<div class="row p-4">
					<div class="col m-auto">
						<button class="submit-button btn btn-lg btn-outline-primary btn-block m-auto" type="submit">Spremi</button>
					</div>
					<div class="col m-auto">
						<a href="javascript:window.history.back()" class="submit-button btn btn-lg btn-outline-danger btn-block">Odustani</a>
					</div>
				</div>	
			</form>
		</div>
	</div>
</div>

<script type="text/javascript">
	document.getElementById('id_image_group').onclick = function(event){
    	document.getElementById('id_image_file').click();
    };

	function readURL(input){
		var reader = new FileReader();
		reader.onload = function (e) {
            $('#id_image_display')
                .attr('src', e.target.result)
        };
		reader.readAsDataURL(input.files[0]);
	}
</script>

{% endblock content %}